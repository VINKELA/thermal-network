<div class="convex-root">
  <google-map height="64vh" width="100%" [center]="center" [zoom]="zoom" #map>
    <ng-container *ngFor="let c of clusters">
      <map-polygon *ngIf="c.hull && c.hull.length>2" [paths]="c.hull" [options]="{fillOpacity:0.16, strokeOpacity:0.9, strokeWeight:1.4}"></map-polygon>
      <map-marker *ngIf="c.latitude && c.longitude" [position]="{lat:c.latitude, lng:c.longitude}" (mapClick)="onSelectCluster(c)"></map-marker>
    </ng-container>
  </google-map>

  <aside class="list-column">
    <h3>Clusters</h3>
    <div *ngIf="loading">Loading...</div>
    <div *ngIf="error" class="error">{{ error }}</div>
    <ul>
      <li *ngFor="let c of clusters" (click)="onSelectCluster(c)">
        <div>{{ c.name || ('Cluster ' + c.id) }}</div>
        <div>Buildings: {{ c.buildings?.length ?? 0 }} â€¢ Peak: {{ formatKw(c.aggregate_peak_kw) }}</div>
      </li>
    </ul>
  </aside>
</div>
